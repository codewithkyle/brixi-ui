let l=null,r=null,a=0,n=0,f=!1;function c(e){n+=e,self.postMessage({type:"tick",data:e})}function d(e){a=e,self.postMessage({type:"start",data:a})}function i(e){self.postMessage({type:"error",data:e})}function g(){self.postMessage({type:"done",data:r})}async function p(e,s){try{f=!0;const t=await fetch(e,s);if(t.ok){for(d(parseInt(t.headers.get("content-length"))),l=t.body.getReader(),n=0,r=new Uint8Array(a);n<a;){const{done:u,value:o}=await l.read();if(r.set(o,n),c(o.byteLength),u)break}g()}else i(t.statusText)}catch(t){i(t)}}self.onmessage=e=>{if(!f){const{url:s,options:t}=e.data;p(s,t)}};
