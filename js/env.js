import{UUID as a}from"./uuid.js";class d{constructor(){this.handleNetworkChange=()=>{this.connection=window.navigator.connection.effectiveType,sessionStorage.removeItem("connection-choice")};this.memory=4,this.cpu=window.navigator?.hardwareConcurrency||2,this.connection="4g",this.domState="booting",this.dataSaver=!1,this.browser="unknown",this.tickets=[]}boot(){this.setBrowser(),"connection"in navigator&&(this.connection=window.navigator.connection.effectiveType,this.dataSaver=window.navigator.connection.saveData,navigator.connection.onchange=this.handleNetworkChange.bind(this)),"deviceMemory"in navigator&&(this.memory=window.navigator.deviceMemory),this.tickets.length?this.setDOMState("loading"):this.setDOMState("idling")}stopLoading(e){if(!e||typeof e!="string"){console.error("A ticket with the typeof 'string' is required to end the loading state.");return}const t=this.tickets.indexOf(e);t!==-1&&this.tickets.splice(t),this.tickets.length===0&&this.domState==="loading"&&this.setDOMState("idling")}startLoading(){this.domState==="idling"&&this.setDOMState("loading");const e=a();return this.tickets.push(e),e}setDOMState(e){this.domState=e,this.domState!=="loading"&&(this.tickets=[]),document.documentElement.setAttribute("state",this.domState)}checkConnection(e){let t=!1;switch(e){case"4g":this.connection!=="2g"&&this.connection!=="slow-2g"&&this.connection!=="3g"&&(t=!0);break;case"3g":this.connection!=="2g"&&this.connection!=="slow-2g"&&(t=!0);break;case"2g":this.connection!=="slow-2g"&&(t=!0);break;case"slow-2g":t=!0;break;default:t=!0;break}return t}setBrowser(){const e=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t=typeof InstallTrigger!="undefined",s=/constructor/i.test(window.HTMLElement)||function(c){return c.toString()==="[object SafariRemoteNotification]"}(!window.safari||typeof safari!="undefined"&&safari.pushNotification),r=!!document.documentMode,i=!r&&!!window.StyleMedia,o=!!window.chrome,n=o&&navigator.userAgent.indexOf("Edg")!=-1;e?this.browser="opera":t?this.browser="firefox":s?this.browser="safari":r?this.browser="ie":i?this.browser="edge":o?this.browser="chrome":n?this.browser="chromium-edge":this.browser="unknown",document.documentElement.setAttribute("browser",this.browser)}mount(e,t){this.bind(e,t)}bind(e,t){customElements.get(e)||customElements.define(e,t)}css(e){return new Promise(async t=>{Array.isArray(e)||(e=[e]),e.length||t();let s=0;for(let r=0;r<e.length;r++){const i=e[r];let o;i.indexOf("https://")===0||i.indexOf("http://")===0||i.indexOf("./")===0||i.indexOf("../")===0||i.indexOf("/")===0?o=i:o=`${location.origin}/css/${i.replace(/\.css$/g,"").trim()}.css`;let n=document.head.querySelector(`link[href="${o}"]`);n?(s++,s===e.length&&t()):new Promise(c=>{n=document.createElement("link"),n.href=o,n.rel="stylesheet",n.onload=()=>{c()},n.onerror=()=>{c()},document.head.appendChild(n)}).then(()=>{s++,s===e.length&&t()})}})}}const h=new d;export{h as default};
