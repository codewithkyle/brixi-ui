import c from"./supercomponent.js";import{html as i,render as h}from"./lit-html.js";import{unsafeHTML as n}from"./unsafe-html.js";import r from"./env.js";import l from"./soundscape.js";import{noop as d,parseDataset as m}from"./general.js";class o extends c{constructor(t){super();this.handleChange=t=>{const e=t.currentTarget;this.set({enabled:e.checked}),this.model.callback(e.checked),e.checked?l.play("activate"):l.play("deactivate")};this.handleKeyup=t=>{if(t.key===" "){const e=this.querySelector("input");e.checked=!e.checked,this.classList.remove("is-active"),this.set({enabled:e.checked}),this.model.callback(e.checked),e.checked?l.play("activate"):l.play("deactivate")}};this.handleKeydown=t=>{t.key===" "&&this.classList.add("is-active")};this.model={name:"",label:"",labelIcon:"",altLabel:"",altLabelIcon:"",enabled:!1,disabled:!1,callback:d,color:"primary",css:"",class:"",attributes:{}},this.model=m(this.dataset,this.model),r.css("lightswitch").then(()=>{this.set(t,!0),this.render()})}getName(){return this.model.name}getValue(){return this.model.enabled}renderText(t){let e;return t.length?e=i` <div>${t}</div> `:e="",e}resize(){const t=this.querySelector("label"),e=t.querySelector("span:first-of-type"),s=t.querySelector("span:last-of-type"),a=this.querySelector("i");this.model.enabled?(t.style.width=`${e.scrollWidth+23+16}px`,e.style.transform="translateX(0)",s.style.transform="translateX(0)",a.style.transform="translateX(0)"):(t.style.width=`${s.scrollWidth+23+18}px`,e.style.transform=`translateX(-${e.scrollWidth+8}px)`,s.style.transform=`translateX(-${e.scrollWidth+8}px)`,a.style.transform=`translateX(-${e.scrollWidth+8}px)`)}render(){this.setAttribute("color",this.model.color);const t=`${this.model.altLabel.replace(/\s+/g,"-").trim()}-${this.model.name}-${this.model.label.replace(/\s+/g,"-").trim()}`,e=i`
            <input @change=${this.handleChange} type="checkbox" name="${this.model.name}" id="${t}" ?disabled=${this.model.disabled} .checked=${this.model.enabled} />
            <label for="${t}" tabindex="0" @keyup=${this.handleKeyup} @keydown=${this.handleKeydown} aria-label=${this.model.enabled?this.model.altLabel:this.model.label}>
                <span> ${n(this.model.altLabelIcon)} ${this.renderText(this.model.altLabel)} </span>
                <i></i>
                <span> ${n(this.model.labelIcon)} ${this.renderText(this.model.label)} </span>
            </label>
        `;this.className=this.model.class,this.style.cssText=this.model.css,Object.keys(this.model.attributes).map(s=>{this.setAttribute(s,`${this.model.attributes[s]}`)}),h(e,this),setTimeout(this.resize.bind(this),80)}}r.bind("lightswitch-component",o);export{o as default};
