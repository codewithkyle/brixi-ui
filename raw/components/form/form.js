import{html as a,render as m}from"./lit-html.js";import u from"./supercomponent.js";import o from"./env.js";import{noop as n,parseDataset as c}from"./general.js";const i="[form-input]:not(checkbox-group checkbox-component):not(radio-group radio-component)";class l extends u{constructor(t){super();this.handleSubmit=t=>{t.preventDefault(),this.model.onSubmit(this)};this.handleReset=t=>{t.preventDefault(),this.reset(),this.model.onReset()};this.model={css:"",class:"",attributes:{},view:null,onSubmit:n,onReset:n},this.model=c(this.dataset,this.model),o.css(["form"]).then(()=>{this.set(t,!0),this.render()})}start(){const t=this.querySelector("submit-button");t&&t.trigger("START")}stop(){const t=this.querySelector('submit-button[state="SUBMITTING"]');t&&t.trigger("STOP")}reset(){this.querySelectorAll(i).forEach(t=>{t.reset()})}serialize(){this.start();const t={};let s=!0;return this.querySelectorAll(i).forEach(e=>{if(e.validate()){const r=e.getName();r==null||r===""?console.error("Form input is missing a name attribute.",e):t[r]=e.getValue()}else s=!1}),t}checkValidity(){let t=!0;return this.querySelectorAll(i).forEach(s=>{s.validate()||(t=!1)}),t}fail(t){const s={};this.querySelectorAll(i).forEach(e=>{s[e.getName()]=e});for(const e in t)s?.[e]?.setError(t[e]);this.stop()}render(){this.className=this.model.class,this.style.cssText=this.model.css,Object.keys(this.model.attributes).map(s=>{this.setAttribute(s,`${this.model.attributes[s]}`)});const t=a` <form @submit=${this.handleSubmit} @reset=${this.handleReset}>${this.model.view}</form> `;m(t,this)}}o.bind("form-component",l);export{l as default};
